#region Prolog
vNow     = TIMST (NOW(), '\Y\m\d\h\i\s' );
# User infos
vUser = 'apikey';
vAPIKey = 'azE6dXNyXzcwNzk3OTVmLTAwMzMtMzM0OS1hZjEzLTVjOTg4NzliYmQ0NTpFQXB4SlpNL01tRG00YVFJN3dLaGxVWFArWm1rMEo2dGVhSE1sNTNwU3RnPTpQSjE0' ;
vCredentials = vUser | ':' | vAPIKey;
# Env infos
vHost ='https://eu-central-1.planninganalytics.saas.ibm.com';
vTenant = 'DDZZBR27IKOU' ;
vDBS = 'PAaaS_Test';
vDBT = 'Test_Git' ;


# Send data in target using the tm1.Update call and a tuple

sDatas = '
	{"Cells":[
	    {"Tuple@odata.bind": [
	        "Dimensions(''plan_version'')/Hierarchies(''plan_version'')/Elements(''FY 2004 Budget'')",
	        "Dimensions(''plan_business_unit'')/Hierarchies(''plan_business_unit'')/Elements(''10300'')",
	        "Dimensions(''plan_department'')/Hierarchies(''plan_department'')/Elements(''105'')",
	        "Dimensions(''plan_chart_of_accounts'')/Hierarchies(''plan_chart_of_accounts'')/Elements(''61015'')",
	        "Dimensions(''plan_exchange_rates'')/Hierarchies(''plan_exchange_rates'')/Elements(''local'')",
            "Dimensions(''plan_source'')/Hierarchies(''plan_source'')/Elements(''input'')",
	        "Dimensions(''plan_time'')/Hierarchies(''plan_time'')/Elements(''Jan-2004'')"
	        ]
	    }
    ],
	"Value":"1234"}
';

######################
# Sen Data   - /api/v1/Cubes('Couts')/tm1.Update
sTokenUrlCellsetID = vHost| '/api/'| vTenant | '/v0/tm1/' | vDBT | '/api/v1/Cubes(''plan_BudgetPlan'')//tm1.Update';
ExecuteHttpRequest( 'POST', sTokenUrlCellsetID , '-u '| vCredentials , '-h Content-Type:application/json' , '-d' | sDatas );
# Parse body to get the cellsetID
sResponseBodyCellsetID = HttpResponseGetBody();
nResponseCodeCellsetID = HttpResponseGetStatusCode();
nGetCellsetID = SCAN( '"ID":' , sResponseBodyCellsetID); 
sGetCellsetID =SUBST( sResponseBodyCellsetID, nGetCellsetID +6 , (LONG(sResponseBodyCellsetID) - nGetCellsetID) -7);

ASCIIOutput('/Output/body_POST.json', NumberToString( nGetCellsetID) , NumberToString( nResponseCodeCellsetID) , NumberToString( LONG(sResponseBodyCellsetID) ) , sGetCellsetID );





#endregion